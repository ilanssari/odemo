name: Compile and Test

on:
  pull_request:
    types: [opened,edited,reopened,review_requested,synchronize]

jobs:
  compile_n_test:
    #runs-on: ubuntu-latest
    runs-on: odemo
    if: ${{ github.base_ref == 'master' }}

    steps:
      - uses: actions/checkout@v2
        with:
          repository: 'ilanssari/odemo'
          ref: ${{ github.head_ref }}
      - name: Set up JDK 1.8
        uses: actions/setup-java@v1
        with:
          java-version: 13.0.1
          java-package: jdk
      - name: Maven compile and test
        run: mvn -s /etc/maven/custom/settings.xml clean test install
      #- uses: mshick/add-pr-comment@v1
      #  with:
      #    message: |
      #      The comilation and tests for @${{ github.sha }} are successfully passed !
      #    repo-token: ${{ github.token }}
      #    repo-token-user-login: 'github-actions[bot]' # The user.login for temporary GitHub tokens
      #    allow-repeats: false # the default is false